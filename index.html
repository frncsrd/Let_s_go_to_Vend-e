<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Checklist Vente / Achat 2026</title>
  <style>
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:#0b0c10;
      color:#e9ecf5;
    }
    .wrap{
      max-width:1000px;
      margin:auto;
      padding:20px;
    }
    h1{margin-bottom:6px;}
    .meta{color:#8b93a7;font-size:14px;margin-bottom:20px;}

    .section{
      background:#12141b;
      border:1px solid #232839;
      border-radius:12px;
      padding:15px;
      margin-bottom:15px;
    }

    .task{
      display:flex;
      align-items:flex-start;
      gap:10px;
      margin:6px 0;
    }

    textarea{
      width:100%;
      min-height:150px;
      margin-top:10px;
      background:#12141b;
      border:1px solid #232839;
      color:white;
      border-radius:8px;
      padding:10px;
    }

    button{
      background:#2dd4bf;
      border:none;
      padding:8px 12px;
      border-radius:6px;
      cursor:pointer;
      font-size:13px;
    }

    input[type="text"]{
      padding:6px;
      border-radius:6px;
      border:1px solid #232839;
      background:#0b0c10;
      color:white;
    }

    .adder{
      margin-top:10px;
      display:flex;
      gap:10px;
    }

    .progress{
      margin:20px 0;
    }

    .bar{
      height:10px;
      background:#232839;
      border-radius:6px;
      overflow:hidden;
    }

    .bar-fill{
      height:100%;
      width:0%;
      background:#2dd4bf;
      transition:0.3s;
    }
  </style>
</head>
<body>
<div class="wrap">
  <h1>Checklist Vente / Achat 2026</h1>
  <div class="meta">
    Achat : 16 mai 2026 — Vente : 29 juin 2026
  </div>

  <div class="progress">
    <div class="bar"><div class="bar-fill" id="bar"></div></div>
    <div id="stats" style="margin-top:6px;font-size:13px;color:#8b93a7;"></div>
  </div>

  <div id="sections"></div>

  <div class="section">
    <h3>Notes globales</h3>
    <textarea id="notes" placeholder="Notes, rendez-vous, points à surveiller..."></textarea>
  </div>
</div>

<script>
const STORAGE = "checklist_vente_achat_2026";

const base = [
  {
    title:"Février – Mars",
    tasks:[
      "Vérifier promesse purgée",
      "Confirmer date notaire 29 juin",
      "Transmettre diagnostics / taxe foncière",
      "Demander 3 devis déménageurs"
    ]
  },
  {
    title:"Avril",
    tasks:[
      "Souscrire assurance nouveau bien",
      "Réserver déménageur",
      "Préparer changements d’adresse"
    ]
  },
  {
    title:"Mai",
    tasks:[
      "Signature achat 16 mai",
      "Relever compteurs",
      "Mettre en service eau / électricité"
    ]
  },
  {
    title:"29 Juin",
    tasks:[
      "Signature vente",
      "Remettre clés",
      "Relever compteurs"
    ]
  }
];

let model = JSON.parse(localStorage.getItem(STORAGE)) || base;

function save(){
  localStorage.setItem(STORAGE, JSON.stringify(model));
  updateStats();
}

function updateStats(){
  let total = 0, done = 0;
  model.forEach(sec=>{
    sec.tasks.forEach(t=>{
      total++;
      if(t.done) done++;
    });
  });
  const pct = total ? Math.round(done/total*100) : 0;
  document.getElementById("bar").style.width = pct+"%";
  document.getElementById("stats").textContent = done+" / "+total+" tâches ("+pct+"%)";
}

function render(){
  const container = document.getElementById("sections");
  container.innerHTML="";

  model.forEach((section,sIndex)=>{
    const div = document.createElement("div");
    div.className="section";
    div.innerHTML="<h3>"+section.title+"</h3>";

    section.tasks.forEach((task,tIndex)=>{
      const row = document.createElement("div");
      row.className="task";
      row.innerHTML=`
        <input type="checkbox" ${task.done?"checked":""}>
        <span>${task.text || task}</span>
      `;

      const cb = row.querySelector("input");
      cb.addEventListener("change",()=>{
        if(typeof section.tasks[tIndex]==="string"){
          section.tasks[tIndex]={text:section.tasks[tIndex],done:cb.checked};
        }else{
          section.tasks[tIndex].done=cb.checked;
        }
        save();
      });

      div.appendChild(row);
    });

    const adder = document.createElement("div");
    adder.className="adder";
    adder.innerHTML=`
      <input type="text" placeholder="Ajouter un élément">
      <button>Ajouter</button>
    `;

    const input = adder.querySelector("input");
    const btn = adder.querySelector("button");

    btn.addEventListener("click",()=>{
      if(!input.value.trim()) return;
      section.tasks.push({text:input.value,done:false});
      input.value="";
      save();
      render();
    });

    div.appendChild(adder);
    container.appendChild(div);
  });

  updateStats();
}

document.getElementById("notes").value = localStorage.getItem("notes") || "";
document.getElementById("notes").addEventListener("input",e=>{
  localStorage.setItem("notes",e.target.value);
});

render();
</script>
</body>
</html>
